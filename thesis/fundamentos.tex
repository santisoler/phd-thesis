\chapter{Fundamentos Geofísicos}

\section{Campo potencial gravitatorio}

Según la Ley de Gravitación Universal de Newton, una masa puntual $m_p$ situada
en la posición $\mathbf{p}$ siente una fuerza gravitatoria $\mathbf{F}$ debido
a la presencia de otra masa $m$ situada en la posición $\mathbf{q}$. Esta
fuerza puede expresarse como:

\begin{equation}
    \mathbf{F} =
        - G \frac{m_p m}{|\mathbf{p} - \mathbf{q}|^3} (\mathbf{p} - \mathbf{q}),
\end{equation}

\noindent donde $G = 6.67430 \times 10^{-11} \text{m}^3 \text{kg}^{-1}
\text{s}^{-2}$ es la constante de gravitación universal
(Fig.~\ref{fig:potencial-gravitatorio}a).
Aplicando la segunda Ley de Newton, se deduce que la masa $m_p$ siente una
aceleración gravitatoria $\mathbf{g}$:

\begin{equation}
    \mathbf{g} =
        - \frac{G m}{|\mathbf{p} - \mathbf{q}|^3} (\mathbf{p} - \mathbf{q}).
    \label{eq:aceleracion-newton}
\end{equation}

Si consideramos que la partícula $m_p$ es una \emph{partícula de prueba},
podemos reescribir la ecuación \ref{eq:aceleracion-newton}, pero ahora
resignificándola como la aceleración gravitatoria que sentiría cualquier
partícula localizada en un punto $\mathbf{p}$ debido a la presencia de la
partícula $m$:

\begin{equation}
    \mathbf{g}(\mathbf{p}) =
        - \frac{G m}{|\mathbf{p} - \mathbf{q}|^3} (\mathbf{p} - \mathbf{q}).
\end{equation}

Se puede demostrar que la atracción gravitatoria $\mathbf{g}$ define un campo
irrotacional, es decir:

\begin{equation}
    \nabla \times \mathbf{g} = 0.
\end{equation}

\noindent Por ende es posible definir un potencial escalar $V$ al que
denominaremos \emph{potencial gravitatorio}:

\begin{equation}
    \mathbf{g}(\mathbf{p}) = + \nabla V(\mathbf{p}),
    \label{eq:potencial-gravitatorio-definicion}
\end{equation}

\noindent donde

\begin{equation}
    V(\mathbf{p}) = G \frac{m}{|\mathbf{p} - \mathbf{q}|}.
    \label{eq:potencial-gravitatorio-particula}
\end{equation}

\noindent Vale la pena notar que en la ecuación
\ref{eq:potencial-gravitatorio-definicion} se ha aplicado la convención de
signo positivo para definir el potencial $V$, mayormente utilizada en la
literatura sobre Geofísica y Geodesia
\citep{heiskanen1967,blakely1995,hinze2009}.

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{figs/gravity-potentials.pdf}
    \caption{
        (a)~Masas puntuales $m_p$ y $m$ localizadas en $\mathbf{p}$
        y $\mathbf{q}$, respectivamente.
        (b)~Distribución de masa $\Gamma$, diferencial de masa $\diff m$
        ubicado en el punto $\mathbf{q}$.
    }
    \label{fig:potencial-gravitatorio}
\end{figure}


\subsection{Potencial gravitatorio por una distribución de masa}

Partiendo de que un diferencial de masa $\diff m$ ubicado en $\mathbf{q}$
genera un potencial gravitatorio $\diff V$ en cualquier punto $\mathbf{p}$
(Fig.~\ref{fig:potencial-gravitatorio}b):

\begin{equation}
    \diff V(\mathbf{p}) = \frac{G}{|\mathbf{p} - \mathbf{q}|} \diff m,
\end{equation}

\noindent el potencial gravitatorio generado por una distribución de masa
$\Gamma$ puede calcularse integrando los diferenciales de masa que lo componen:

\begin{equation}
    V(\mathbf{p}) =
        G \int\limits_\Gamma \frac{\diff m}{|\mathbf{p} - \mathbf{q}|} .
\end{equation}

Si reescribimos los diferenciales de masa como

\begin{equation}
    \diff m = \rho(\mathbf{q}) \diff v,
\end{equation}

\noindent donde $\rho(\mathbf{q})$ es la densidad de masa de la distribución
$\Gamma$ en el punto $\mathbf{q}$ y $\diff v$ es el diferencial de volumen,
el potencial se puede expresar como:

\begin{equation}
    V(\mathbf{p}) =
        G \int\limits_\Gamma
        \frac{\rho(\mathbf{q})}{|\mathbf{p} - \mathbf{q}|} \diff v.
    \label{eq:potencial-gravitatorio-integral}
\end{equation}


\subsection{Gradiente del potencial gravitatorio}

Según la definición del potencial gravitatorio expuesta en la
ecuación~\ref{eq:potencial-gravitatorio-definicion}, es posible calcular la
aceleración de la gravedad producida por una distribución de masa arbitraria
en cualquier punto $\mathbf{p}$ como el gradiente del potencial
$V(\mathbf{p})$.
Si definimos un sistema de ejes Cartesianos en el cual el punto $\mathbf{p}
= (x, y, z)$, las componentes de la aceleración en cada una de las direcciones
del sistema quedan expresadas
como:

\begin{equation}
    g_i(\mathbf{p}) = \frac{\partial V(\mathbf{p})}{\partial i}, \,\,
        \forall i \in \{x, y, z\}.
    \label{eq:componentes-aceleracion-gravitatoria}
\end{equation}

El vector
$\mathbf{g}(\mathbf{p}) = (g_x(\mathbf{p}), g_y(\mathbf{p}), g_z(\mathbf{p}))$
representa la aceleración gravitatoria en el punto
$\mathbf{p}$ generada por la distribución de masa $\Gamma$, aunque es común
referirse al mismo como el \emph{gradiente gravitatorio}.
Reemplazando la ecuación~\ref{eq:potencial-gravitatorio-integral}
en~\ref{eq:componentes-aceleracion-gravitatoria}, las componentes del gradiente
gravitatorio pueden expresarse como:

\begin{align}
    g_x(\mathbf{p}) &=
        - G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{(x - x')}{|\mathbf{p} - \mathbf{q}|^3} \diff v,
    \label{eq:gx-integral}
    \\
    g_y(\mathbf{p}) &=
        - G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{(y - y')}{|\mathbf{p} - \mathbf{q}|^3} \diff v,
    \label{eq:gy-integral}
    \\
    g_z(\mathbf{p}) &=
        - G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{(z - z')}{|\mathbf{p} - \mathbf{q}|^3} \diff v,
    \label{eq:gz-integral}
\end{align}

\noindent donde $\mathbf{q} = (x', y', z')$.

Las segundas derivadas del potencial gravitatorio definen el \emph{tensor del
gradiente gravitatorio}, y sus componentes pueden expresarse como:

\begin{equation}
    g_{ij}(\mathbf{p}) =
        \frac{\partial^2 V(\mathbf{p})}{\partial i \partial j}, \,\,
        \forall i \in \{x, y, z\}, \,\,
        \forall j \in \{x, y, z\}.
\end{equation}

Reemplazando la ecuación \ref{eq:potencial-gravitatorio-integral}, podemos
expresar las componentes diagonales del tensor de la siguiente manera
\citep{grombein2013}:

\begin{align}
    g_{xx}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \left[
        \frac{3(x - x')^2}{|\mathbf{p} - \mathbf{q}|^5}
        - \frac{1}{|\mathbf{p} - \mathbf{q}|^3}
        \right]
        \diff v,
    \label{eq:gxx-integral}
    \\
    g_{yy}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \left[
        \frac{3(y - y')^2}{|\mathbf{p} - \mathbf{q}|^5}
        - \frac{1}{|\mathbf{p} - \mathbf{q}|^3}
        \right]
        \diff v,
    \label{eq:gyy-integral}
    \\
    g_{zz}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \left[
        \frac{3(z - z')^2}{|\mathbf{p} - \mathbf{q}|^5}
        - \frac{1}{|\mathbf{p} - \mathbf{q}|^3}
        \right]
        \diff v,
    \label{eq:gzz-integral}
\end{align}

\noindent mientras que las componentes no diagonales pueden expresarse como:

\begin{align}
    g_{xy}(\mathbf{p}) =
    g_{yx}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{3(x - x')(y - y')}{|\mathbf{p} - \mathbf{q}|^5}
        \diff v,
    \label{eq:gxy-integral}
    \\
    g_{xz}(\mathbf{p}) =
    g_{zx}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{3(x - x')(z - z')}{|\mathbf{p} - \mathbf{q}|^5}
        \diff v,
    \label{eq:gxz-integral}
    \\
    g_{yz}(\mathbf{p}) =
    g_{zy}(\mathbf{p}) &=
        G \int\limits_\Gamma \rho(\mathbf{q})
        \frac{3(y - y')(z - z')}{|\mathbf{p} - \mathbf{q}|^5}
        \diff v.
    \label{eq:gyz-integral}
\end{align}

A partir de las ecuaciones~\ref{eq:gxx-integral}--\ref{eq:gzz-integral} podemos
calcular el Laplaciano del potencial gravitatorio:

\begin{equation}
    \nabla^2 V(\mathbf{p}) =
        \frac{\partial^2 V}{\partial x^2}
        + \frac{\partial^2 V}{\partial y^2}
        + \frac{\partial^2 V}{\partial z^2},
\end{equation}

\noindent Dado que las tres expresiones se cancelan mutuamente
\citep{blakely1995}, podemos concluir que cualquier potencial gravitatorio es
un \emph{campo harmónico}

\begin{equation}
    \nabla^2 V(\mathbf{p}) = 0
    \label{eq:potencial-laplace}
\end{equation}

\noindent para cualquier punto de observación $\mathbf{p}$ fuera de la
distribución de masa $\Gamma$.

Vale notar que la ecuación de Laplace \ref{eq:potencial-laplace} es válida
solo para regiones libres de masas, y representa un caso particular de la
ecuación de Poisson \citep{blakely1995}:

\begin{equation}
    \nabla^2 V(\mathbf{p}) = -4\pi G \rho,
    \label{eq:potencial-poisson}
\end{equation}

\noindent válida para cualquier punto de observación $\mathbf{p}$.

% =============================================================================

\section{Modelado directo}

El cálculo de los efectos gravitatorios de un determinado cuerpo sobre uno
o más puntos de observación se suele denominar modelado directo (\emph{forward
modelling} en inglés).
Aunque las expresiones del potencial gravitatorio
(ec.~\ref{eq:potencial-gravitatorio-integral}),
las componentes de su gradiente
(ecs.~\ref{eq:gx-integral}--\ref{eq:gz-integral})
y de su tensor (ecs.~\ref{eq:gxx-integral}--\ref{eq:gzz-integral}
aparentan ser sencillas, el cómputo de estas magnitudes para una geometría dada
no resulta un problema trivial.
Solo existen soluciones analíticas a dichas expresiones para determinadas
geometrías sencillas o que guardan algún tipo de simetría.

En el desarrollo de esta Tesis nos resultan de principal interés trabajar con
tres tipos de geometrías: masas puntuales, prismas rectangulares y prismas
esféricos o \emph{tesseroides}.

\subsection{Masas puntuales}

La distribución de densidades de una masa puntual puede expresarse
sencillamente mediante una Delta de Dirac \citep{vladimirov1979}:

\begin{equation}
    \rho(\mathbf{q}) = m \, \delta(\mathbf{q} - \mathbf{q'}),
\end{equation}

\noindent donde $\mathbf{q}$ y $m$ son la posición y la masa de la partícula,
respectivamente.
Reemplazando esta expresión en la
ecuación~\ref{eq:potencial-gravitatorio-integral}, obtenemos el potencial
gravitatorio generado por una partícula:

\begin{equation}
    V(\mathbf{p}) =
        G \int\limits_\Gamma
        m \frac{\delta(\mathbf{q} - \mathbf{q'})}{|\mathbf{p} - \mathbf{q'}|}
        \diff v =
        \frac{G m}{|\mathbf{p} - \mathbf{q}|},
    \label{eq:potencial-masa-puntual}
\end{equation}

\noindent de acuerdo con la expresión del potencial de la
ecuación~\ref{eq:potencial-gravitatorio-particula}.

Realizando el mismo reemplazos en las ecuaciones correspondientes a las
componentes del gradiente (ecs.~\ref{eq:gx-integral}--\ref{eq:gz-integral})
arribamos a las siguientes expresiones:

\begin{align}
    g_x(\mathbf{p}) &=
        - G m
        \frac{x - x'}{|\mathbf{p} - \mathbf{q}|^3},
    \label{eq:gx-particula}
    \\
    g_y(\mathbf{p}) &=
        - G m
        \frac{y - y'}{|\mathbf{p} - \mathbf{q}|^3},
    \label{eq:gy-particula}
    \\
    g_z(\mathbf{p}) &=
        - G m
        \frac{z - z'}{|\mathbf{p} - \mathbf{q}|^3}.
    \label{eq:gz-particula}
\end{align}

A la hora de realizar el cómputo de los campos gravitatorios de masas
puntuales, las posiciones de las partículas como de los puntos de observación
pueden venir dados en diferentes sistemas de coordenadas.
En el caso de necesitar modelar cualquier conjunto de masas situadas bajo la
superficie terrestre, resulta natural utilizar coordenadas esféricas tanto para
las posiciones de las partículas como para los puntos de observación.
Sin embargo, es muy común trabajar sobre zonas de estudio con dimensiones
acotadas, bajo las cuales la aproximación de tierra plana es suficiente. En
estos casos es posible trabajar en coordenadas Cartesianas.

\subsubsection{Coordenadas Cartesianas}

En el caso de que la posición de la partícula venga dada por el vector
$\mathbf{q} = (x', y', z')$ y el punto de observación por el vector
$\mathbf{p} = (x, y, z)$ definidos en el mismo sistema de ejes Cartesianos, el
módulo de
$\mathbf{p} - \mathbf{q}$ se calcula sencillamente bajo la norma L$_2$:

\begin{equation}
    | \mathbf{p} - \mathbf{q} | = \sqrt{
        (x - x')^2 + (y - y')^2 + (z - z')^2
    }.
\end{equation}

Dado que los numeradores en las
ecuaciones~\ref{eq:gx-particula}--\ref{eq:gz-particula} resultan triviales en
coordenadas Cartesianas, el cómputo del potencial y las componentes de su
gradiente se puede realizar de manera sencilla.

\subsubsection{Coordenadas esféricas}

Consideremos que las posiciones del punto de observación y de la partícula
vienen dados en un sistema de coordenadas esféricas. Para ello vamos a definir
un sistema de referencia \emph{geocéntrico} $\{X, Y, Z\}$ y a partir del mismo
un sistema de coordenadas esféricas $\{r, \lambda, \phi\}$, donde $r$ es la
posición \emph{radial}, $\lambda$ la posición \emph{longitudinal} y $\phi$ la
posición \emph{latitudinal} (Fig.~\ref{fig:spherical-coordinates}).
Cualquier punto dado por las coordenadas esféricas $(r, \lambda, \phi)$ se
puede expresar en coordenadas Cartesianas geocéntricas bajo las siguientes
relaciones:

\begin{equation}
    \begin{cases}
        X = r \cos\lambda \cos{\phi} \\
        Y = r \sin\lambda \cos{\phi} \\
        Z = r \sin{\phi},
    \end{cases}
\end{equation}

\noindent donde $r \in [0, \infty)$, $\lambda \in (-\pi, \pi]$ y
$\phi \in [-\pi/2, \pi/2]$.

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{figs/spherical-coordinates.pdf}
    \caption{
        Masa puntual $m$ ubicada en la posición $\mathbf{q}$ y punto de
        observación situado en $\mathbf{p}$.
        Se define un sistema de referencia Cartesiano \emph{geocéntrico} $X, Y,
        Z$ bajo el cual se considera un sistema de coordenadas esféricas dadas
        por la distancia radial ($r$), ángulo longitudinal ($\lambda$) y ángulo
        latitudinal ($\phi$).
        En el punto $\mathbf{p}$ se define un sistema \emph{local} de
        coordenadas Cartesiano: el eje $x$ apunta hacia el Este,
        el eje $y$ hacia el Norte geométrico y el eje $z$ en la dirección
        radial.
        Se define a $\psi$ como el ángulo descripto por los vectores
        $\mathbf{p}$ y $\mathbf{q}$, y $\alpha$ al ángulo azimutal de
        $-(\mathbf{p} - \mathbf{q})$ sobre el sistema \emph{local}.
    }
    \label{fig:spherical-coordinates}
\end{figure}

El potencial gravitatorio que genera la partícula $m$ sobre el punto de
observación $\mathbf{p}$ puede calcularse mediante la
ecuación~\ref{eq:potencial-gravitatorio-particula}.
Considerando que los vectores $\mathbf{p}$ y $\mathbf{q}$ vienen definidos por
las coordenadas esféricas $(r, \lambda, \phi)$ y $(r', \lambda', \phi')$,
respectivamente, la distancia Euclidiana entre ellos puede expresarse como
\citep{grombein2013}:

\begin{equation}
    |\mathbf{p} - \mathbf{q}| = \sqrt{
        r^2 + r'^2 - 2rr'\cos\psi
    },
    \label{eq:distance-spherical}
\end{equation}

\noindent donde $\psi$ es el ángulo que describen los vectores $\mathbf{p}$
y $\mathbf{q}$:

\begin{equation}
    \cos \psi =
        \sin \phi \sin \phi' + \cos \phi \cos \phi' \cos(\lambda - \lambda').
    \label{eq:cosphi}
\end{equation}

La determinación de las componentes del gradiente del potencial gravitatorio
hace necesario que definamos las direcciones ortogonales $x$, $y$ y $z$ a lo
largo de las cuales se calculan las derivadas parciales de $V(\mathbf{p})$.
La elección más natural es obtener el gradiente con respecto a un sistema de
coordenadas \emph{local} $\{x, y, z\}$ \citep{grombein2013,uieda2016} donde $x$
se orienta en la dirección longitudinal (Este), $y$ en la dirección latitudinal
(Norte) y $z$ en la dirección radial.

Los numeradores de las ecuaciones~\ref{eq:gx-particula}--\ref{eq:gz-particula}
pueden expresarse en términos de las coordenadas esféricas como:

\begin{align}
    \Delta x &= - (x - x') = r' \sin\psi \cos\alpha
    \label{eq:delta-x-raw}
    \\
    \Delta y &= - (y - y') = r' \sin\psi \sin\alpha
    \label{eq:delta-y-raw}
    \\
    \Delta z &= - (z - z') = r'\cos\psi - r,
    \label{eq:delta-z-raw}
\end{align}

\noindent donde $\alpha$ es el ángulo azimutal del vector
$-(\mathbf{p} - \mathbf{q})$ sobre el sistema de coordenadas \emph{locales}.
Haciendo uso de las siguientes relaciones de trigonometría esférica
\citep[][p.~113]{heiskanen1967}:

\begin{align}
    \sin\psi \cos\alpha &=
        \cos\phi \sin\phi' - \sin\phi \cos\phi' \cos(\lambda - \lambda') \\
    \sin\psi \sin\alpha &=
        \cos\phi' \sin(\lambda - \lambda'),
\end{align}

\noindent podemos expresar las ecuaciones~\ref{eq:delta-x-raw},
\ref{eq:delta-y-raw} y \ref{eq:delta-z-raw} como \citep{grombein2013}:

\begin{align}
    \Delta x &= r' \sin\psi \left[
        \cos\phi \sin\phi' - \sin\phi \cos\phi' \cos(\lambda - \lambda')
        \right]
    \label{eq:delta-x}
    \\
    \Delta y &= r' \cos\phi' \sin(\lambda - \lambda')
    \label{eq:delta-y}
    \\
    \Delta z &= r'\cos\psi - r.
    \label{eq:delta-z}
\end{align}

Las componentes del gradiente del potencial gravitatorio generado por una masa
puntual en coordenadas esféricas quedan determinadas de la siguiente manera:

\begin{align}
    g_x(\mathbf{p}) &=
        G m
        \frac{\Delta x}{|\mathbf{p} - \mathbf{q}|^3},
    \label{eq:gx-particula-spherical}
    \\
    g_y(\mathbf{p}) &=
        G m
        \frac{\Delta y}{|\mathbf{p} - \mathbf{q}|^3},
    \label{eq:gy-particula-spherical}
    \\
    g_z(\mathbf{p}) &=
        G m
        \frac{\Delta z}{|\mathbf{p} - \mathbf{q}|^3},
    \label{eq:gz-particula-spherical}
\end{align}

\noindent haciendo uso de las ecuaciones~\ref{eq:distance-spherical},
\ref{eq:cosphi}, \ref{eq:delta-x}, \ref{eq:delta-y} y \ref{eq:delta-z}.


\subsection{Prismas rectangulares}

A la hora de modelar estructuras tridimensionales subyacentes a la superficie
terrestre, los primas rectangulares se presentan como la geometría a elección
por parte de muchos autores y muchas autoras \citep{}.
Una de las razones recae en la simpleza de la geometría, aunque una que no
debemos obviar es el hecho de que existen soluciones analíticas a las
ecuaciones de los campos gravitatorios generados por prismas rectangulares
\citep{nagy2000,nagy2002}.

Consideremos un prisma rectangular de densidad homogénea $\rho$ cuyos vértices
se encuentran determinados por las coordenadas $X_1, X_2, Y_1, Y_2, Z_1, Z_2$
definidas en un sistema de ejes Cartesianos ${X, Y, Z}$
(Fig.~\ref{fig:rectangular-prism}).
El potencial gravitatorio que genera el prisma sobre un punto de observación
$\mathbf{p} = (X, Y, Z)$ definido en el sistema ${X, Y, Z}$ se puede
calcular mediante la ecuación~\ref{eq:potencial-gravitatorio-integral},
reemplazando el dominio de integración:

\begin{equation}
    V(\mathbf{p}) =
    G \rho
    \int\limits_{X_1}^{X_2}
    \int\limits_{Y_1}^{Y_2}
    \int\limits_{Z_1}^{Z_2}
    \frac{\diff X' \diff Y' \diff Z'}{|\mathbf{p} - \mathbf{q}|},
\end{equation}

\noindent donde

\begin{equation}
    |\mathbf{p} - \mathbf{q}| = \sqrt{
        (X - X')^2 + (Y - Y')^2 + (Z - Z')^2
    }.
\end{equation}

\begin{figure}
    \centering
    \includegraphics[width=0.6\linewidth]{figs/rectangular-prism.pdf}
    \caption{
        Prisma rectangular y punto de observación $\mathbf{p}$ definidos en un
        sistema de coordenadas Cartesianas $\{X, Y, Z\}$. Se define un sistema
        de coordenadas Cartesianas $\{x, y, z\}$ con origen en el punto de
        observación $\mathbf{p}$ y con ejes paralelos a $X, Y, Z$,
        respectivamente.
    }
    \label{fig:rectangular-prism}
\end{figure}

Con el objetivo de simplificar los cálculos, definimos un sistema de
coordenadas Cartesianas $\{x, y, z\}$ cuyo origen se encuentra en el punto de
observación $\mathbf{p}$ y sus ejes son paralelos a los del sistema $\{X, Y,
Z\}$, respectivamente (Fig.~\ref{fig:rectangular-prism}).
Los vértices del prisma vendrán dados por las coordenadas
$x_1, x_2, y_1, y_2, z_1, z_2$ en el nuevo sistema de referencia, es decir:

\begin{equation}
    \begin{aligned}
        x_1 &= X_1 - X, & x_2 &= X_2 - X, \\
        y_1 &= Y_1 - Y, & y_2 &= Y_2 - Y, \\
        z_1 &= Z_1 - Z, & z_2 &= Z_2 - Z.
    \end{aligned}
\end{equation}

Bajo este nuevo sistema de referencia, el potencial gravitatorio se puede
expresar como:

\begin{equation}
    V(\mathbf{p}) =
    G \rho
    \int\limits_{x_1}^{x_2}
    \int\limits_{y_1}^{y_2}
    \int\limits_{z_1}^{z_2}
    \frac{\diff x' \diff y' \diff z'}{\sqrt{{x'}^2 + {y'}^2 + {z'}^2}}.
\end{equation}

El resultado de esta integración posee la siguiente forma
\citep{nagy2000,nagy2002}:

\begin{equation}
    \begin{split}
        V(\mathbf{p}) =
        G \rho
        \Bigg[ &
            xy \ln (z + l) + yz \ln(x + l) + zx \ln(y + l) \\
               &
            - \frac{x^2}{2} \arctan \frac{yz}{xl}
            - \frac{y^2}{2} \arctan \frac{zx}{yl}
            - \frac{z^2}{2} \arctan \frac{xy}{zl}
        \Bigg]
        \Bigg|_{x_1}^{x_2}
        \Bigg|_{y_1}^{y_2}
        \Bigg|_{z_1}^{z_2},
    \end{split}
    \label{eq:potencial-prismas-analitico}
\end{equation}

\noindent donde

\begin{equation}
    l = \sqrt{x^2 + y^2 + z^2}.
\end{equation}

Reemplazando todos los límites del dominio de integración, obtenemos un total
de 48 términos.
A la hora de evaluarlos numéricamente hay que tener en cuenta que la solución
analítica de la ecuación~\ref{eq:potencial-prismas-analitico} no es
continua en todo $\mathbb{R}^3$, particularmente en los casos en los que el
punto de observación se encuentra sobre alguno de los vértices, aristas o caras
del prisma ($x_{1,2}=0$, $y_{1,2}=0$ ó $z_{1,2}=0$). Sin embargo el potencial
$V(\mathbf{p})$ sí lo es.
Para solucionar esto, es necesario reemplazar aquellos términos que no pueden
ser evaluados por sus límites cuando $(x, y, z) \rightarrow (0, 0, 0)$
\citep{nagy2000}.
Por ejemplo:

\begin{equation}
    \lim_{(x, y, z)\rightarrow (0, 0, 0)} xz \ln(z + r) = 0.
\end{equation}

Una solución es definir una nueva función $\safelog(x)$ de la siguiente
manera:

\begin{equation}
    \safelog(x) =
    \begin{cases}
        \ln(x) & \quad x \ge x_\text{umbral} \\
        0      & \quad x < x_\text{umbral}
    \end{cases}
    \label{eq:safe_log}
\end{equation}

\noindent donde $x_\text{umbral}$ es un valor muy pequeño del argumento de
$\safelog$ a partir del cual consideramos que la función debe ser evaluada en
su límite en cero.
La elección de este valor dependerá de las dimensiones del problema que estamos
resolviendo.
En el caso de un modelado directo geofísico, en el cual las dimensiones de los
primas vienen dadas por varios metros, podemos asumir un valor de
$x_\text{umbral} = 10^{-10}$m \citep{harmonica2021}.

Por otro lado, la evaluación de la función $\arctan$ requiere ciertos cuidados.
Para que el potencial $V(\mathbf{p})$ satisfaga la ecuación de Poisson
(ec.~\ref{eq:potencial-poisson}), es necesario utilizar la siguiente forma de
la función $\safearctan(y, x)$ \citep{fukushima2020}:

\begin{equation}
    \safearctan(y, x) =
    \begin{cases}
        \arctan(y / x) & \quad x \ne 0 \\
        \pi / 2        & \quad x = 0,\, y > 0 \\
        -\pi / 2       & \quad x = 0,\, y < 0 \\
        0              & \quad x = 0,\, y = 0.
    \end{cases}
    \label{eq:safe_arctan}
\end{equation}

Haciendo uso de las funciones $\safelog$ y $\safearctan$ definidas en las
ecuaciones~\ref{eq:safe_log} y \ref{eq:safe_arctan}, respectivamente, el
potencial gravitatorio generado por un prisma rectangular en cualquier punto de
observación $\mathbf{p}$ puede ser numéricamente calculado mediante:

\begin{equation}
    \begin{split}
        V(\mathbf{p}) =
        G \rho
        \Bigg[ &
            xy \safelog (z + l)
            + yz \safelog(x + l)
            + zx \safelog(y + l)
           - \frac{x^2}{2} \safearctan(yz, xl)
                \\&
           - \frac{y^2}{2} \safearctan(zx, yl)
           - \frac{z^2}{2} \safearctan(xy, zl)
        \Bigg]
        \Bigg|_{x_1}^{x_2}
        \Bigg|_{y_1}^{y_2}
        \Bigg|_{z_1}^{z_2}.
    \end{split}
    \label{eq:potencial-prismas-numerico}
\end{equation}

De manera análoga, podemos calcular las componentes del gradiente del potencial
gravitatorio generado por un prisma rectangular haciendo uso de las siguientes
expresiones \citep{nagy2000,nagy2002}:

\begin{align}
    g_x(\mathbf{p}) =&
        \Big[
            y \safelog(z + l) + z \safelog(y + l)  - x \safearctan(yz, xl)
        \Big]
        \Big|_{x_1}^{x_2}
        \Big|_{y_1}^{y_2}
        \Big|_{z_1}^{z_2} \\
    g_y(\mathbf{p}) =&
        \Big[
            z \safelog(x + l) + x \safelog(z + l)  - y \safearctan(zx, yl)
        \Big]
        \Big|_{x_1}^{x_2}
        \Big|_{y_1}^{y_2}
        \Big|_{z_1}^{z_2} \\
    g_z(\mathbf{p}) =&
        \Big[
            x \safelog(y + l) + y \safelog(x + l) - z \safearctan(xy, zl)
        \Big]
        \Big|_{x_1}^{x_2}
        \Big|_{y_1}^{y_2}
        \Big|_{z_1}^{z_2}.
\end{align}


\subsection{Tesseroides}

En caso de querer realizar modelos directos de estructuras regionales,
continentales o globales,
El uso de prismas rectangulares en coordenadas Cartesianas no resulta la mejor
opción, ya que no tienen en cuenta la curvatura del planeta Tierra.
La mayoría de los modelos directos que sí lo hacen se definen en coordenadas
esféricas geocéntricas y consisten en discretizar la Tierra en geometrías
simples.
Este es el caso de los tesseroides \citep{anderson1976}, también conocidos como
prismas esféricos, los cuales se definen como el volumen comprendido entre dos
esferas de radios distintos, dos meridianos de longitudes distintas y dos
paralelos de distintas latitudes (Fig.~\ref{fig:tesseroid}).

\begin{figure}
    \centering
    \includegraphics[width=0.7\linewidth]{figs/tesseroid-coord-sys.pdf}
    \caption{
        Tesseroide (prisma esférico) en un sistema de coordenadas esféricas
        geocéntricas, junto a un punto de cómputo situado en $\mathbf{p}$ y su
        correspondiente sistema \emph{local} de coordenadas Cartesianas.
        Obtenida de \citet{uieda2015}.
    }
    \label{fig:tesseroid}
\end{figure}

El potencial gravitatorio que genera un tesseroide de densidad uniforme $\rho$,
definido por las coordenadas $r_1$, $r_2$, $\lambda_1$, $\lambda_2$, $\phi_1$
y $\phi_2$, sobre un punto de observación $\mathbf{p}$ dado por las coordenadas
esféricas $r$, $\lambda$ y $\phi$ se puede obtener aplicando estos límites de
integración a la ecuación~\ref{eq:potencial-gravitatorio-integral}, quedando
expresado como la siguiente integral volumétrica
\citep{grombein2013,uieda2016}:

\begin{equation}
    V(\mathbf{p}) = G \rho
        \int\limits_{r_1}^{r_2}
        \int\limits_{\lambda_1}^{\lambda_2}
        \int\limits_{\phi_1}^{\phi_2}
        \frac{\kappa}{|\mathbf{p} - \mathbf{q}|}
        \diff r' \diff \lambda' \diff \phi',
    \label{eq:potencial-tesseroide}
\end{equation}

\noindent donde

\begin{equation}
    \kappa = {r'}^2 \cos \phi',
    \label{eq:kappa}
\end{equation}

\noindent la distancia $|\mathbf{p} - \mathbf{q}|$ viene dada por la
ecuación~\ref{eq:distance-spherical} y las coordenadas de integración $r'$,
$\lambda'$ y $\phi'$ representan la posición $\mathbf{q}$ de cada volumen
infinitesimal del tesseroide.

Reemplazando los límites de integración del tesseroide en las ecuaciones
\ref{eq:gx-integral}, \ref{eq:gy-integral} y \ref{eq:gz-integral} podemos
obtener las componentes del gradiente del potencial gravitatorio generado por
el tesseroide en el punto de observación $\mathbf{p}$ tomando las derivadas
parciales con respecto al sistema de coordenadas \emph{local}:


\begin{align}
    g_x(\mathbf{p}) &=
        G \rho
        \int\limits_{r_1}^{r_2}
        \int\limits_{\lambda_1}^{\lambda_2}
        \int\limits_{\phi_1}^{\phi_2}
        \frac{\Delta x}{|\mathbf{p} - \mathbf{q}|^3}
        \kappa
        \diff r' \diff \lambda' \diff \phi',
    \label{eq:gx-tesseroide}
    \\
    g_y(\mathbf{p}) &=
        G \rho
        \int\limits_{r_1}^{r_2}
        \int\limits_{\lambda_1}^{\lambda_2}
        \int\limits_{\phi_1}^{\phi_2}
        \frac{\Delta y}{|\mathbf{p} - \mathbf{q}|^3}
        \kappa
        \diff r' \diff \lambda' \diff \phi',
    \label{eq:gy-tesseroide}
    \\
    g_z(\mathbf{p}) &=
        G \rho
        \int\limits_{r_1}^{r_2}
        \int\limits_{\lambda_1}^{\lambda_2}
        \int\limits_{\phi_1}^{\phi_2}
        \frac{\Delta z}{|\mathbf{p} - \mathbf{q}|^3}
        \kappa
        \diff r' \diff \lambda' \diff \phi',
    \label{eq:gz-tesseroide}
\end{align}

\noindent donde $\Delta x$, $\Delta y$ y $\Delta z$ vienen dadas por las
ecuaciones~\ref{eq:delta-x}, \ref{eq:delta-y} y \ref{eq:delta-z},
respectivamente.

Las ecuaciones~\ref{eq:potencial-tesseroide}, \ref{eq:gx-tesseroide},
\ref{eq:gy-tesseroide} y \ref{eq:gz-tesseroide} contienen integrales elípticas
que no poseen solución analítica y deben ser aproximadas numéricamente.
Existen dos principales métodos en la literatura para aproximar estas
integrales: uno involucra expansiones en serie de Taylor
\citep{heck2006,grombein2013} mientras que los otros hacen uso de la \ac{GLQ}
\citep{asgharzadeh2007,wildpfeiffer2008,li2011,uieda2016,lin2018}.
En el Capítulo~\ref{cha:tesseroids-variable-density} se detalla las razones por
las cuales a lo largo de esta Tesis abordaremos la estrategia de \ac{GLQ}.

La \Ac{GLQ} consiste en la aproximación de una integral por una suma ponderada
del kernel de integración \citep[][p.~390]{hildebrand1987}:

\begin{equation}
    \int\limits_{-1}^1 f(x) \diff x \approx
        \sum\limits_{i=1}^{N} W_i f(x_i),
\end{equation}

\noindent donde $N$ es el orden de la cuadratura,
$x_i$ corresponden a las raíces del polinomio de Legendre $P_N(x)$ de grado $N$
y $W_i$ son los pesos ponderados de cada término:

\begin{equation}
    W_i = \frac{2}{(1 - x_i^2) \Big[ P'_N(x_i) \Big]^2}.
\end{equation}

\noindent El polinomio de Legendre $P_N(x)$ y su primera derivada $P'_N(x)$ se
pueden obtener mediante relaciones de recurrencia \citep[][p.~330]{hildebrand1987}:

\begin{align}
    &P_0(x) = 1 \\
    &P_1(x) = x \\
    &P_{m + 1}(x) = \frac{2m + 1}{m + 1} x P_m(x) - \frac{m}{m + 1}P_{m-1}(x).
\end{align}

La Tabla~\ref{tab:legendre-roots} muestra las raíces de los primeros polinomios
de Legendre y sus respectivos pesos ponderados.

\begin{table}
    \centering
    \caption{
        Raíces de algunos polinomios de Legendre junto con los correspondientes
        pesos ponderados a ser utilizados en la \ac{GLQ}
        \citep[][p.~392]{hildebrand1987}.
    }
    \begin{tabular}{ccc}
        \hline
        Orden ($N$) & Raíces ($x_i$)                                     & Pesos ponderados ($W_i$)    \\
        \hline
        1     & 0                                                        & 2                           \\
        2     & $\pm \frac{1}{\sqrt{3}}$                                 & 1                           \\
        3     & 0                                                        & $\frac{8}{9}$               \\
              & $\pm \sqrt{\frac{3}{5}}$                                 & $\frac{5}{9}$               \\
        4     & $\pm \sqrt{\frac{3}{7} - \frac{2}{7}\sqrt{\frac{6}{5}}}$ & $\frac{18 + \sqrt{30}}{36}$ \\
              & $\pm \sqrt{\frac{3}{7} + \frac{2}{7}\sqrt{\frac{6}{5}}}$ & $\frac{18 - \sqrt{30}}{36}$
    \end{tabular}
    \label{tab:legendre-roots}
\end{table}

En el caso de que la integral posea límites de integración distintos a
$[-1, 1]$, podemos escalar los nodos y aplicar la \ac{GLQ} de la siguiente
forma:

\begin{equation}
    \int\limits_a^b f(x) \diff x \approx
        \frac{b - a}{2} \sum\limits_{i=1}^{N}
        W_i f(x_i^s),
\end{equation}

\noindent donde

\begin{equation}
    x_i^s = \frac{b - a}{2} x_i + \frac{b + a}{2}.
\end{equation}

Haciendo uso de la \ac{GLQ}, podemos aproximar las integrales volumétricas de
las ecuaciones~\ref{eq:potencial-tesseroide}, \ref{eq:gx-tesseroide},
\ref{eq:gy-tesseroide}, \ref{eq:gz-tesseroide} de la siguiente manera
\citep{asgharzadeh2007,uieda2016}:

\begin{equation}
    \int\limits_{r_1}^{r_2}
    \int\limits_{\lambda_1}^{\lambda_2}
    \int\limits_{\phi_1}^{\phi_2}
    f(r', \lambda', \phi')
    \diff r' \diff \lambda' \diff \phi' =
    A
    \sum\limits_{i=1}^{N_r}
    \sum\limits_{j=1}^{N_\lambda}
    \sum\limits_{k=1}^{N_\phi}
    W_i^r
    W_j^\lambda
    W_k^\phi
    f(r_i, \lambda_j, \phi_j),
    \label{eq:glq-integral-volumetrica}
\end{equation}

\noindent donde

\begin{equation}
    A = \frac{
        (r_2 - r_1) (\lambda_2 - \lambda_1) (\phi_2 - \phi_1)
    }{8},
\end{equation}

\noindent $N_r$, $N_\lambda$ y $N_\phi$ son los ordenes de la cuadratura en
cada dirección; $r_i$, $\lambda_j$ y $\phi_k$ representan los nodos escalados
de las cuadraturas para cada dirección; y $W_i^r$, $W_j^\lambda$, $W_k^\phi$
sus respectivos pesos ponderados.

Como se puede observar en la ecuación~\ref{eq:glq-integral-volumetrica}, la
\ac{GLQ} aproxima los campos gravitatorios de un tesseroide por los que genera
un conjunto de masas puntuales situadas en los nodos escalados de los
polinomios de Legendre.
La precisión de la aproximación dependerá entonces de la cantidad de nodos
utilizados en las sumatorias, es decir, de los ordenes de las cuadraturas.
De esta forma podemos aumentar la precisión de la \ac{GLQ} incrementando los
ordenes de las cuadraturas.
Sin embargo, el aumento de cada cuadratura incrementa la cantidad de nodos
según $O(n^3)$, haciendo de esta estrategia un método muy ineficiente.

\citet{ku1977} demostró que la precisión de la aproximación también depende del
cociente entre la distancia al punto de observación y la distancia entre nodos
adyacentes.
Haciendo uso de esto, \citet{li2011} han propuesto un método más eficiente para
aumentar la precisión de la aproximación manteniendo: la \emph{discretización
adaptativa}.
Esta consiste en mantener el orden de las cuadraturas constantes e ir
dividiendo el tesseroide en otros tesseroides de menor tamaño según la
distancia entre ellos y el punto de observación.
De esta forma, se incrementa la cantidad de nodos en las regiones que mayor
afectan a la precisión, obteniendo un número considerablemente menor de nodos
pero manteniendo una buena precisión.
En el Capítulo \ref{cha:tesseroids-variable-density} describiremos en detalle
la \emph{discretización adaptativa}.

% =============================================================================

\section{Disturbio de gravedad}

\subsection{Elipsoide de referencia}

\section{Fuentes equivalentes}
