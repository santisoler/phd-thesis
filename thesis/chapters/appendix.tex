\chapter{Soluciones analíticas para un cascarón esférico}
\label{cha:shell}

Consideremos un cascarón esférico con radio interior $R_1$ y radio exterior
$R_2$, cuya densidad es función $\rho(r')$ de la coordenada radial.
Deseamos obtener una expresión analítica para los campos gravitatorios que
general en cualquier punto externo ubicado a una distancia $r$ del centro del
cascarón ($r > R_2$).

Según el Teorema del Cascarón de Newton (\emph{Newton's Shell Theorem, Theorem
XXXI}) \citep{chandrasekhar1995, binney2008}, el potencial gravitatorio
generado por el cascarón esférico en cualquier punto externo es equivalente
al que generaría si toda su masa estuviera concentrada en un punto localizado
en su centro:

\begin{equation}
    V_\text{sh}(\phi, \lambda, r) = \frac{GM}{r},
\end{equation}

\noindent donde $M$ es la masa total del cascarón, la cual puede ser fácilmente
calculada como:

\begin{equation}
    M =
    \iiint\limits_{\Omega} \rho(r') dV =
    4\pi \int\limits_{R_1}^{R_2} \rho(r') {r'}^2 dr',
\end{equation}

\noindent donde $\Omega$ simboliza el volumen del cascarón.

Combinando las dos ecuaciones anteriores, obtenemos la siguiente expresión para
el potencial:

\begin{equation}
    V_\text{sh}(r) = \frac{4\pi G}{r}
    \int\limits_{R_1}^{R_2} {r'}^2 \rho(r') \, dr',
\label{eq:shell-pot}
\end{equation}

\noindent la cual es equivalente a la obtenida por \citet[p.62]{binney2008}.

El gradiente de potenciales que dependen solo de $r$ poseen solo una componente
no nula: la componente vertical del gradiente ($g_z$).
Según \citet{grombein2013}:

\begin{equation}
    g_z(r) = \frac{V_\text{sh}(r)}{r}.
\label{eq:shell-gz}
\end{equation}

A partir de la ecuación~\ref{eq:shell-pot} podemos obtener expresiones del
potencial gravitatorio para diferentes funciones de densidad. La integración de
las siguientes funciones de densidad fueron llevadas a cabo mediante el uso de
SymPy \citep{sympy2017}, una librería de Python para matemática simbólica.

\section{Densidad lineal}

Para una densidad lineal

\begin{equation}
    \rho(r') = ar' + b\ ,
\end{equation}

\noindent
el potencial gravitatorio en cualquier punto externo es

\begin{equation}
    V_\text{sh}^\text{lin}(r) = \pi G \left[
    a \frac{R_2^4 - R_1^4}{r} +
    b \,\frac{4}{3} \frac{R_2^3 - R_1^3}{r} \right].
    \label{eq:shell-pot-linear}
\end{equation}

\noindent El primer término de la ecuación reproduce el potencial generado por
un cascarón esférico con densidad variable $\rho(r') = ar'$, mientras que el
segundo término es equivalente al potencial generado por el mismo cascarón con
densidad homogénea $\rho = b$ \citep{mikuska2006,grombein2013}.
La ecuación~\ref{eq:shell-pot-linear} coincide con la obtenida por \citet{lin2019}.

\section{Densidad exponencial}

Para una densidad exponencial

\begin{equation}
    \rho(r') = A e^{- k (r' - R)},
\end{equation}

\noindent donde $A$, $k$ y $R$ son constantes, el potencial gravitatorio en
cualquier punto exterior es

\begin{equation}
    \begin{split}
        V_\text{exp}(r) = \frac{4\pi G}{r} \frac{A}{k^3} \Big[
        & \left( R_1^2 k^2 + 2 R_1 k + 2 \right) e^{- k (R_1 - R)} - \\
        & \left( R_2^2 k^2 + 2 R_2 k + 2 \right) e^{- k (R_2 - R)}
        \Big].
    \end{split}
\end{equation}


\section{Densidad sinusoidal}

Para una función de densidad sinusoidal

\begin{equation}
    \rho(r') = A \sin ( k (r' - R)),
\end{equation}

\noindent donde $A$, $k$ y $R$ son constantes, el potencial gravitatorio en
cualquier punto exterior es

\begin{equation}
    \begin{split}
        V_\text{sine}(r) = \frac{4\pi G}{r} \frac{A}{k^3} \Big[
    & (2 - k^2 R_2^2) \cos(k(R_2 - R)) + \\
    & 2 k R_2 \sin(k(R_2 - R)) - \\
    & (2 - k^2 R_1^2) \cos(k(R_1 - R)) - \\
    & 2 k R_1 \sin(k(R_1 - R))
    \Big].
    \end{split}
\end{equation}


\chapter{Source position parameters used for the tests on synthetic data}
\label{cha:sources}

Tables~\ref{tab:parameters-ground-survey}
and~\ref{tab:parameters-airborne-survey} show the parameter values tested and
their optimal values for creating the equivalent source distributions tested in
Section~\ref{sec:synthetic_distributions}.
The optimal values were used to produce the results in
Figs~\ref{fig:ground-survey-differences}
and~\ref{fig:airborne-survey-differences}.

{\renewcommand\normalsize{\scriptsize}%
\normalsize

\begin{table}
    \centering
    \caption{
        Parameters used to produce each source distribution for interpolating
        the synthetic ground survey data. Also contains the set of parameters
        that generates the smallest RMS error for each source distribution and
        their corresponding RMS.
    }
    \label{tab:parameters-ground-survey}
    \begin{tabular}{c c l c c c}
        \textbf{Source layout}
            & \textbf{Depth type}
            & \multicolumn{1}{c}{\textbf{Parameters}}
            & \textbf{Values}
            & \textbf{Best}
            & \textbf{RMS} \\
        \toprule

        \multirow{8}{*}{Source Below Data}
            & \multirow{2}{*}{Constant}
                & Depth (m)
                & \GroundSourceBelowDataConstantDepthDepth
                & \BestGroundSourceBelowDataConstantDepthDepth
                & \multirow{2}{*}{
                    \BestGroundSourceBelowDataConstantDepthRms
                  } \\
            &
                & Damping
                & \GroundSourceBelowDataConstantDepthDamping
                & \BestGroundSourceBelowDataConstantDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{2}{*}{Relative}
                & Depth (m)
                & \GroundSourceBelowDataRelativeDepthDepth
                & \BestGroundSourceBelowDataRelativeDepthDepth
                & \multirow{2}{*}{
                    \BestGroundSourceBelowDataRelativeDepthRms
                  } \\
            &
                & Damping
                & \GroundSourceBelowDataRelativeDepthDamping
                & \BestGroundSourceBelowDataRelativeDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{4}{*}{Variable}
                & Depth (m)
                & \GroundSourceBelowDataVariableDepthDepth
                & \BestGroundSourceBelowDataVariableDepthDepth
                & \multirow{4}{*}{
                    \BestGroundSourceBelowDataVariableDepthRms
                  } \\
            &
                & Depth factor
                & \GroundSourceBelowDataVariableDepthDepthFactor
                & \BestGroundSourceBelowDataVariableDepthDepthFactor
                & \\
            &
                & $k$ neighbours
                & \GroundSourceBelowDataVariableDepthKNearest
                & \BestGroundSourceBelowDataVariableDepthKNearest
                & \\
            &
                & Damping
                & \GroundSourceBelowDataVariableDepthDamping
                & \BestGroundSourceBelowDataVariableDepthDamping
                & \\
        \midrule

        \multirow{11}{*}{Block Averaged Sources}
            & \multirow{3}{*}{Constant}
                & Depth (m)
                & \GroundBlockAveragedSourcesConstantDepthDepth
                & \BestGroundBlockAveragedSourcesConstantDepthDepth
                & \multirow{3}{*}{
                    \BestGroundBlockAveragedSourcesConstantDepthRms
                  } \\
            &
                & Block size (m)
                & \GroundBlockAveragedSourcesConstantDepthSpacing
                & \BestGroundBlockAveragedSourcesConstantDepthSpacing
                & \\
            &
                & Damping
                & \GroundBlockAveragedSourcesConstantDepthDamping
                & \BestGroundBlockAveragedSourcesConstantDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{3}{*}{Relative}
                & Depth (m)
                & \GroundBlockAveragedSourcesRelativeDepthDepth
                & \BestGroundBlockAveragedSourcesRelativeDepthDepth
                & \multirow{3}{*}{
                    \BestGroundBlockAveragedSourcesRelativeDepthRms
                  } \\
            &
                & Block size (m)
                & \GroundBlockAveragedSourcesRelativeDepthSpacing
                & \BestGroundBlockAveragedSourcesRelativeDepthSpacing
                & \\
            &
                & Damping
                & \GroundBlockAveragedSourcesRelativeDepthDamping
                & \BestGroundBlockAveragedSourcesRelativeDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{5}{*}{Variable}
                & Depth (m)
                & \GroundBlockAveragedSourcesVariableDepthDepth
                & \BestGroundBlockAveragedSourcesVariableDepthDepth
                & \multirow{5}{*}{
                    \BestGroundBlockAveragedSourcesVariableDepthRms
                  } \\
            &
                & Depth factor
                & \GroundBlockAveragedSourcesVariableDepthDepthFactor
                & \BestGroundBlockAveragedSourcesVariableDepthDepthFactor
                & \\
            &
                & $k$ neighbours
                & \GroundBlockAveragedSourcesVariableDepthKNearest
                & \BestGroundBlockAveragedSourcesVariableDepthKNearest
                & \\
            &
                & Block size (m)
                & \GroundBlockAveragedSourcesVariableDepthSpacing
                & \BestGroundBlockAveragedSourcesVariableDepthSpacing
                & \\
            &
                & Damping
                & \GroundBlockAveragedSourcesVariableDepthDamping
                & \BestGroundBlockAveragedSourcesVariableDepthDamping
                & \\
        \midrule

        \multirow{4}{*}{Grid Sources}
            & \multirow{4}{*}{Constant}
                & Depth (m)
                & \GroundGridSourcesConstantDepthDepth
                & \BestGroundGridSourcesConstantDepthDepth
                & \multirow{4}{*}{
                    \BestGroundGridSourcesConstantDepthRms
                  } \\
            &
                & Grid spacing (m)
                & \GroundGridSourcesConstantDepthSpacing
                & \BestGroundGridSourcesConstantDepthSpacing
                & \\
            &
                & Damping
                & \GroundGridSourcesConstantDepthDamping
                & \BestGroundGridSourcesConstantDepthDamping
                & \\
    \end{tabular}
\end{table}

\begin{table}
    \centering
    \caption{
        Parameters used to produce each source distribution for interpolating
        the synthetic airborne survey data. Also contains the set of parameters
        that generates the smallest RMS error for each source distribution and
        their corresponding RMS.
    }
    \label{tab:parameters-airborne-survey}
    \begin{tabular}{c c l c c c}
        \textbf{Source layout}
            & \textbf{Depth type}
            & \multicolumn{1}{c}{\textbf{Parameters}}
            & \textbf{Values}
            & \textbf{Best}
            & \textbf{RMS} \\
        \toprule

        \multirow{8}{*}{Source Below Data}
            & \multirow{2}{*}{Constant}
                & Depth (m)
                & \AirborneSourceBelowDataConstantDepthDepth
                & \BestAirborneSourceBelowDataConstantDepthDepth
                & \multirow{2}{*}{
                    \BestAirborneSourceBelowDataConstantDepthRms
                  } \\
            &
                & Damping
                & \AirborneSourceBelowDataConstantDepthDamping
                & \BestAirborneSourceBelowDataConstantDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{2}{*}{Relative}
                & Depth (m)
                & \AirborneSourceBelowDataRelativeDepthDepth
                & \BestAirborneSourceBelowDataRelativeDepthDepth
                & \multirow{2}{*}{
                    \BestAirborneSourceBelowDataRelativeDepthRms
                  } \\
            &
                & Damping
                & \AirborneSourceBelowDataRelativeDepthDamping
                & \BestAirborneSourceBelowDataRelativeDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{4}{*}{Variable}
                & Depth (m)
                & \AirborneSourceBelowDataVariableDepthDepth
                & \BestAirborneSourceBelowDataVariableDepthDepth
                & \multirow{4}{*}{
                    \BestAirborneSourceBelowDataVariableDepthRms
                  } \\
            &
                & Depth factor
                & \AirborneSourceBelowDataVariableDepthDepthFactor
                & \BestAirborneSourceBelowDataVariableDepthDepthFactor
                & \\
            &
                & $k$ neighbours
                & \AirborneSourceBelowDataVariableDepthKNearest
                & \BestAirborneSourceBelowDataVariableDepthKNearest
                & \\
            &
                & Damping
                & \AirborneSourceBelowDataVariableDepthDamping
                & \BestAirborneSourceBelowDataVariableDepthDamping
                & \\
        \midrule

        \multirow{11}{*}{Block Averaged Sources}
            & \multirow{3}{*}{Constant}
                & Depth (m)
                & \AirborneBlockAveragedSourcesConstantDepthDepth
                & \BestAirborneBlockAveragedSourcesConstantDepthDepth
                & \multirow{3}{*}{
                    \BestAirborneBlockAveragedSourcesConstantDepthRms
                  } \\
            &
                & Block size (m)
                & \AirborneBlockAveragedSourcesConstantDepthSpacing
                & \BestAirborneBlockAveragedSourcesConstantDepthSpacing
                & \\
            &
                & Damping
                & \AirborneBlockAveragedSourcesConstantDepthDamping
                & \BestAirborneBlockAveragedSourcesConstantDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{3}{*}{Relative}
                & Depth (m)
                & \AirborneBlockAveragedSourcesRelativeDepthDepth
                & \BestAirborneBlockAveragedSourcesRelativeDepthDepth
                & \multirow{3}{*}{
                    \BestAirborneBlockAveragedSourcesRelativeDepthRms
                  } \\
            &
                & Block size (m)
                & \AirborneBlockAveragedSourcesRelativeDepthSpacing
                & \BestAirborneBlockAveragedSourcesRelativeDepthSpacing
                & \\
            &
                & Damping
                & \AirborneBlockAveragedSourcesRelativeDepthDamping
                & \BestAirborneBlockAveragedSourcesRelativeDepthDamping
                & \\
            \cmidrule{2-6}
            & \multirow{5}{*}{Variable}
                & Depth (m)
                & \AirborneBlockAveragedSourcesVariableDepthDepth
                & \BestAirborneBlockAveragedSourcesVariableDepthDepth
                & \multirow{5}{*}{
                    \BestAirborneBlockAveragedSourcesVariableDepthRms
                  } \\
            &
                & Depth factor
                & \AirborneBlockAveragedSourcesVariableDepthDepthFactor
                & \BestAirborneBlockAveragedSourcesVariableDepthDepthFactor
                & \\
            &
                & $k$ neighbours
                & \AirborneBlockAveragedSourcesVariableDepthKNearest
                & \BestAirborneBlockAveragedSourcesVariableDepthKNearest
                & \\
            &
                & Block size (m)
                & \AirborneBlockAveragedSourcesVariableDepthSpacing
                & \BestAirborneBlockAveragedSourcesVariableDepthSpacing
                & \\
            &
                & Damping
                & \AirborneBlockAveragedSourcesVariableDepthDamping
                & \BestAirborneBlockAveragedSourcesVariableDepthDamping
                & \\
        \midrule

        \multirow{4}{*}{Grid Sources}
            & \multirow{4}{*}{Constant}
                & Depth (m)
                & \AirborneGridSourcesConstantDepthDepth
                & \BestAirborneGridSourcesConstantDepthDepth
                & \multirow{4}{*}{
                    \BestAirborneGridSourcesConstantDepthRms
                  } \\
            &
                & Grid spacing (m)
                & \AirborneGridSourcesConstantDepthSpacing
                & \BestAirborneGridSourcesConstantDepthSpacing
                & \\
            &
                & Damping
                & \AirborneGridSourcesConstantDepthDamping
                & \BestAirborneGridSourcesConstantDepthDamping
                & \\
    \end{tabular}
\end{table}
}
